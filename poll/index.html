<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>polls - Adhocracy+</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "polls";
        var mkdocs_page_input_path = "poll.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Adhocracy+
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">HOWTO</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../installation_dev/">install for development</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../django_shell_basics/">django basics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../management_commands/">management commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../languages_and_translations/">translations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../upgrades/">software upgrades</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../howtomkdocs/">create documentation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../installation_prod/">install on production</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Diagrams</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../diagrams_modules/">participation modules</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../api/">code reference</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Explanations</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../authentication/">authentication</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../celery/">celery</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ckeditor/">ckeditor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../geolocation/">geolocation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../img_saving_and_deletion/">images</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">polls</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../postgresql/">postgresql</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../project_insights/">project insights</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../img_saving_and_deletion/">images</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../software_architecture/">architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tests/">tests</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Repository</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://github.com/liqd/adhocracy-plus">source code</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../contributing/">contribute</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Adhocracy+</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Explanations</li>
      <li class="breadcrumb-item active">polls</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="poll">Poll</h1>
<p>The poll module (aka Survey) can be attached as a participation type in the project's dashboard. A poll has Questions that users can interact either by giving an Answer in text format, or by voting on Choices. A Vote can also receive another vote and an answer. Therefore the way answers and votes are related to the Poll, is through the Question table. Votes particularly are first related to a choice, which choice is related to a question.</p>
<p><img alt="Poll diagram" src="../assets/poll-question-answer-vote-inheritance.png" />
<strong>enlarge the image with right-click</strong></p>
<h1 id="open-poll">Open Poll</h1>
<p>It is an enhancement of the existing a4 Poll module, which was accessible only to registered users.<br />
The open poll allows access to unregister users by a checkbox in the project's dashboard poll module. For this enhanced feature, we decoupled the creator from the poll's answers and votes. The new class <code>GeneratedContentModel</code> - see file <a href="https://github.com/liqd/adhocracy4/blob/main/adhocracy4/models/base.py">adhocracy4/models/base.py</a> has the creator relation as optional, and introduces the new field <code>content_id</code> to provide a unique ID for filtering the answers and votes of a non registered user, because there is no creator. </p>
<p>Answers and Votes classes used to inherit from the <code>UserGeneratedContentModel</code> and have been updated to inherit now from the new <code>GeneratedContentModel</code>, so they may either have a creator or a content_id field. Answer has also a constrain (unique together) in the combination of <code>Question</code>, <code>Creator</code>, <code>Content_id</code> depending on whether a creator or content_id field exists.</p>
<p>Permissions <code>allows_unregistered_users</code> are now also in place for enabling those unregistered users to interact with the open poll - see the file <a href="https://github.com/liqd/adhocracy4/blob/main/adhocracy4/polls/predicates.py">adhocracy4/polls/predicates.py</a>.</p>
<p>For submitting the open poll, we provide a checkbox labelled with <code>agreed_terms_of_use</code> which is equivalent to agreement of the project's terms users have to accept upon signing-up. The terms agreement checheckbox is placed at the end of the poll, along with a <a href="https://github.com/liqd/adhocracy4/blob/main/adhocracy4/static/Captcha.jsx">captcha written in React</a> to filter out robots and spam. Both fields need to filled in by the user in order to be able to submit the poll form.</p>
<p>The open poll is intended for public projects only. Private and semi-private projects require a user account to interact with by design, thus the <code>allow_unregistered_users</code> option in the poll module dashboard has no effect for these type of projects. </p>
<p>Project insights do count unregistered users, and exporting a poll as an excel also counts votes and answers from unregistered users with the prefix 'ANON'.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../img_saving_and_deletion/" class="btn btn-neutral float-left" title="images"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../postgresql/" class="btn btn-neutral float-right" title="postgresql">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../img_saving_and_deletion/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../postgresql/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
