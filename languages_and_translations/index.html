<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>translations - Adhocracy+</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "translations";
        var mkdocs_page_input_path = "languages_and_translations.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Adhocracy+
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">HOWTO</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../installation_dev/">install for development</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../django_shell_basics/">django basics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../management_commands/">management commands</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">translations</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#transifex-installation-and-configuration">Transifex installation and configuration</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#install-the-transifex-client-if-you-havent-already">Install the transifex client if you haven't already</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#register-on-transifex-and-become-member-of-liquid-democracy-projects">Register on transifex and become member of Liquid Democracy projects</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#transifex-local-configuration">Transifex local configuration</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#work-locally-to-generate-translations">Work locally to generate translations:</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#push-new-source-strings-to-transifex">Push new source strings to transifex</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pull-new-translations-from-transifex">Pull new translations from transifex</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#translations-have-been-added-locally-de">Translations have been added locally (DE)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#extra-translations-in-a-branch-or-fork">Extra translations in a branch or fork</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#enable-fork-specific-translations">Enable fork-specific translations</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mark-fork-specific-translations-for-translators">Mark fork-specific translations for translators</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#adding-additional-languages">Adding additional languages</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#to-wagtail-cms-pages">To Wagtail CMS pages</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#to-rest-of-site">To rest of site</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../upgrades/">software upgrades</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../howtomkdocs/">create documentation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../installation_prod/">install on production</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Diagrams</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../diagrams_modules/">participation modules</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../api/">code reference</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Explanations</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../authentication/">authentication</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../celery/">celery</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ckeditor/">ckeditor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../geolocation/">geolocation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../img_saving_and_deletion/">images</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../poll/">polls</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../postgresql/">postgresql</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../project_insights/">project insights</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../img_saving_and_deletion/">images</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../software_architecture/">architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tests/">tests</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Repository</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://github.com/liqd/adhocracy-plus">source code</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../contributing/">contribute</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Adhocracy+</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">HOWTO</li>
      <li class="breadcrumb-item active">translations</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="translations">Translations</h1>
<p>We take care to make all strings in the code (like texts on buttons, headlines that don't come from django models, ...) translatable.</p>
<p>The translations for the main branch are done in transifex. If you want to translate A+ into your language, please get in touch: info [at] liqd [dot] net</p>
<h2 id="transifex-installation-and-configuration">Transifex installation and configuration</h2>
<h3 id="install-the-transifex-client-if-you-havent-already">Install the transifex client if you haven't already</h3>
<ul>
<li>see https://github.com/transifex/cli for instructions</li>
</ul>
<h3 id="register-on-transifex-and-become-member-of-liquid-democracy-projects">Register on transifex and become member of Liquid Democracy projects</h3>
<ol>
<li>register on <a href="https://www.transifex.com/">Transifex website</a> with your email of liqd.net</li>
<li>Make your profile public by visiting <a href="https://app.transifex.com/user/settings/">My profile</a>, scroll down to <code>Privacy</code> section and check the box <code>Make my profile accessible by anyone (public)</code></li>
<li>visit <a href="https://explore.transifex.com/liqd/adhocracy-plus/">Liquid Democracy projects on transifex</a>, choose Adhocracy+ and click on <code>Join this project</code></li>
<li>Ping a colleague who is already member of the transifex liqd organisation to accept your request, e.g your fellow developer.</li>
<li>Generate an API token from your <a href="https://app.transifex.com/user/settings/api/">profile</a>. Save the token somewhere, preferably in your vaultwarden account, as you will be asked to provide it later. Visit official documentation <a href="https://help.transifex.com/en/articles/6248858-generating-an-api-token">here</a></li>
</ol>
<h2 id="transifex-local-configuration">Transifex local configuration</h2>
<p>the adhocracy-plus repository includes the <code>.tx/config</code> file, so no initialization of transifex  or other configuration is required from you.</p>
<h2 id="work-locally-to-generate-translations">Work locally to generate translations:</h2>
<p>From within adhocracy-plus directory, run <code>make install</code> to pull the relative adhocracy4 dependency that should be included for translations</p>
<h4 id="push-new-source-strings-to-transifex">Push new source strings to transifex</h4>
<p>Create new branch and generate message files with the new strings added during development with:</p>
<p><code>make po</code></p>
<p>Test that new messages compile without any errors with:</p>
<p><code>make mo</code>  </p>
<p>Push updated source file with new strings to transifex to be be translated (Note: commented out strings will not be ignored by transifex, but handled as normal source strings, so remove them before from source files)</p>
<p><code>tx push</code><br />
NOTE: you will be asked to provide your API token, which then will be saved in a local file, whose location will be indicated in the terminal. For future authenitcations, you will need to provide it when pushing, or add it as <a href="https://developers.transifex.com/docs/using-the-client#using-environment-variables">enviroment variable in your terminal profile</a>. </p>
<p>Commit and push your branch to github</p>
<h4 id="pull-new-translations-from-transifex">Pull new translations from transifex</h4>
<p>Once translations have been added on transifex, create branch and force pull all translations from transifex (force is needed because the time stamps cause errors)</p>
<p><code>tx pull -af</code></p>
<p>Since translations files pulled from transifex have slightly different format, run</p>
<p><code>make po</code></p>
<p>to standardise.
Test that new messages compile without any errors</p>
<p><code>make mo</code></p>
<p>Then commit and push translations to github</p>
<h3 id="translations-have-been-added-locally-de">Translations have been added locally (DE)</h3>
<p>Sometimes it is necessary to add DE translations directly in the .po files and
not through transifex. This method ensures no translations from DE or other
languages are overwritten and the DE translation are also added to transifex.
Create branch and ensure that all new strings are in source file</p>
<p><code>make po</code></p>
<p>Test that new messages and locally added translations compile without any errors</p>
<p><code>make mo</code></p>
<p>Push updated source file with new strings to transifex to be be translated (again, remember to first remove commented out strings from source files)</p>
<p><code>tx push -s</code></p>
<p>Force push locally added DE translations</p>
<p><code>tx push -t -f -l de</code></p>
<p>After transifex has all the translations you can then force pull and get any new
translations without risk of over-writing local german ones.</p>
<p><code>tx pull -af</code></p>
<h2 id="extra-translations-in-a-branch-or-fork">Extra translations in a branch or fork</h2>
<p>When A+ is used as the basis for another project, it is important to keep
the translations from the main branch separated to be able to overwrite or
add new translations to the fork, but also keep up with new strings and
translations from the main branch.</p>
<h3 id="enable-fork-specific-translations">Enable fork-specific translations</h3>
<p>The message files for the main branch are created by
<code>make po</code>
When the settings in base.py are untouched, this will create new message
files in the locale-source folder, where they can be translated and/or
pushed to transifex like explained above.
<code>make po</code> will also translate the English strings by themselves, meaning
that in the en folder, all missing msgstr are filled with the text from
the corresponding msgid.</p>
<p>When a new project is created by forking or branching, only the
translations in the locale-fork folder should be changed, so that old
translations can be kept and the fork is profiting from new translations
or translation fixes when it is rebased onto the main branch.
To create the new translations, go to the
<a href="https://github.com/liqd/adhocracy-plus/blob/main/adhocracy-plus/config/settings/base.py">base settings</a>
and uncomment the first path
(os.path.join(BASE_DIR, 'locale-fork/locale')) in LOCALE_PATHS.
Now, <code>make po</code> creates message files in the locale-fork folder and
uses the translations from this folder first, whenever the messages are
compiled.
Here, the English translations are kept untranslated, so that they could
be used to overwrite strings.</p>
<h3 id="mark-fork-specific-translations-for-translators">Mark fork-specific translations for translators</h3>
<p>There are two options to mark the strings for translators:
1. By comments, that are displayed to translators. Django docs on comments for translaters
    - <a href="https://docs.djangoproject.com/en/3.2/topics/i18n/translation/#comments-for-translators">in python code</a>
    - and <a href="https://docs.djangoproject.com/en/3.2/topics/i18n/translation/#translator-comments-in-templates">in templates</a>
2. By using the context of the translations. Django docs on contextualizing translations
    - [in python code]](https://docs.djangoproject.com/en/3.2/topics/i18n/translation/#contextual-markers)
    - <a href="https://docs.djangoproject.com/en/3.2/topics/i18n/translation/#std:templatetag-translate">in templates</a>
    - and <a href="https://docs.djangoproject.com/en/3.2/topics/i18n/translation/#pgettext">in js</a></p>
<p>We recommend option 1 because that is more easily changed back if the strings to translate happen to end up in the upstream repo. As of now, there is no option to add these translator comments in JavaScript code, so these have to be marked with the context option if needed.</p>
<h2 id="adding-additional-languages">Adding additional languages</h2>
<h3 id="to-wagtail-cms-pages">To Wagtail CMS pages</h3>
<p>Add the language to the CMS page models that you require them for. If
translations are only needed for legal pages such as Data Protection ect. then
only add language to SimplePage model as this is the page type used for all legal
information.
In translations.py add new language to either the TranslatedField (to enable
translations for all CMS page types) or TranslatedFieldLegal to just include it
for SimplePages.
When adding to all page types add fallback descriptions to settings/models.py.</p>
<h3 id="to-rest-of-site">To rest of site</h3>
<p>Add additional language to base.py.
Update tests.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../management_commands/" class="btn btn-neutral float-left" title="management commands"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../upgrades/" class="btn btn-neutral float-right" title="software upgrades">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../management_commands/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../upgrades/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
