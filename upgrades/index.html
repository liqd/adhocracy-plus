<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>software upgrades - Adhocracy+</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "software upgrades";
        var mkdocs_page_input_path = "upgrades.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Adhocracy+
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">HOWTO</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../installation_dev/">install for development</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../django_shell_basics/">django basics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../management_commands/">management commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../languages_and_translations/">translations</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">software upgrades</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#django">Django</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#wagtail">Wagtail</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../howtomkdocs/">create documentation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../installation_prod/">install on production</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Diagrams</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../diagrams_modules/">participation modules</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../api/">code reference</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Explanations</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../authentication/">authentication</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../celery/">celery</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ckeditor/">ckeditor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../geolocation/">geolocation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../img_saving_and_deletion/">images</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../poll/">polls</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../postgresql/">postgresql</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../project_insights/">project insights</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../img_saving_and_deletion/">images</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../software_architecture/">architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tests/">tests</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Repository</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://github.com/liqd/adhocracy-plus">source code</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../contributing/">contribute</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Adhocracy+</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">HOWTO</li>
      <li class="breadcrumb-item active">software upgrades</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="upgrades-for-our-software-django-and-wagtail">Upgrades for our software -- Django and Wagtail.</h1>
<p>Before scheduling upgrades, we need to check version support across Django and Wagtail. For example we may need to upgrade up to a certain version of Django in order to support latest Wagtail, which it supports the latest Django release. Moreover, sometimes we would need to wait for an upgrade due to other dependencies that are not supporting latest releases.</p>
<h2 id="django">Django</h2>
<p>For Django upgrades, we follow the recommended steps from <a href="https://docs.djangoproject.com/en/5.2/howto/upgrade-version/">Django's official documentation</a>. 
Before starting upgrade, we run the tests with <code>py.test tests --reuse-db</code> or <code>make tests</code> and we try to fix all deprecation warnings that are related to our code base, and not those related to external installed packages and libraries.
The most thorough step is to look at the release notes of the <code>final</code> release from the one after our current Django version, up to and including the version to which we plan to upgrade. E.g if our current version is 4.2.x, we upgrade first to the latest version of this release (that is 4.2.22) and then incrementally to the last release of the next feature release. E.g the next and final feature release of 4.2.x is 5.0.14. We read the release notes of each version we are updating to, and ensure that deprecated and removed coding blocks and features are updated in our code accordingly. </p>
<p>For each version upgrade we run the tests to check if they pass. 
We then apply the migrations that will affect the Database schema by running the migrate command with <code>python manage.py migrate</code>.
If in the process of upgrading we have changed our models, e.g by how the index is declared, or the field, or any change, we need to run <code>python manage.py makemigrations</code> and if new migrations files are generated we need to run the migrate command as above. 
We commit each version upgrade separately with a message that includes <code>django upgrade</code> + version. This way and in case something went wrong on the live servers, we can revoke back to a previous version more easily.</p>
<ul>
<li>All release notes are found <a href="https://docs.djangoproject.com/en/5.2/releases/">here</a>.</li>
<li>Helpfull tool for upgrading</li>
<li>Example of a previous <a href="https://github.com/liqd/adhocracy4/pull/1504/commits">Django upgrade</a>. In this PR we see the different commits for each upgrade, and also for each package that needs upgrade before we jump to a higher version that requires said package.</li>
</ul>
<h2 id="wagtail">Wagtail</h2>
<p>The process is similar to Django, that we upgrade one feature release at a time, even if our current wagtail version is several versions behind the current one. For example, instead of going from 6.0 directly to 6.3, upgrade to 6.1 and 6.2 first rather than skipping directly to the newest release. For each upgrade, we read though the release notes for feature removals/deprecations, and migrations we need to run similar to the Django upgrade process.</p>
<ul>
<li>Official Wagtail upgrade release notes and howto, see <a href="https://docs.wagtail.org/en/stable/releases/upgrading.html">here</a>.</li>
<li>Example of a previous <a href="https://github.com/liqd/adhocracy-plus/pull/2868/commits">Wagtail upgrade</a>.</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../languages_and_translations/" class="btn btn-neutral float-left" title="translations"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../howtomkdocs/" class="btn btn-neutral float-right" title="create documentation">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../languages_and_translations/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../howtomkdocs/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
